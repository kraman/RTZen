<project name="RTZen ORB Hello Demo" default="compile">

    <property name="package.dir" value="demo/hello"/>
    <property name="idl.src" value="hello.idl"/>
    

    <import file="../../../init.xml"/>
    <import file="../demo_tasks.xml"/>

    <target name="compile">
        <idlc file="${zen.srcdir}/${package.dir}/${idl.src}"/>
        <demo.compile/>
        <jar
            jarfile="${zen.libdir}/hello_world.jar"
            basedir="${zen.classdir}"
            includes="${package.dir}/**"/>
        <antcall target="compile.jrate"/>
    </target>

    <target name="compile.jrate" if="compiler_jRate">
        <demo.compile.jrate main="demo.hello.Client" out="client">
            <fileset dir="${zen.srcdir}/${package.dir}">
                <include name="Client.java"/>
                <exclude name="Server.java"/>
            </fileset>
            <fileset dir="${zen.gendir}/${package.dir}">
                <include name="*.java"/>
            </fileset>
         </demo.compile.jrate>
    </target>

    <target name="server">
        <demo.run classname="demo.hello.Server"/>
    </target>
    
    <target name="client">
        <demo.run classname="demo.hello.Client"/>
    </target>    
    
    <!-- set "jacorb.home" properly to use jacorb examples -->
    <property name="jacorb.home" value="/home/yuez/JacORB_2_2"/>
    
    <property name="jacorb.jvmarg" value="-Xbootclasspath/p:${jacorb.home}/lib/jacorb.jar${path.separator}${zen.classdir}${path.separator}${jacorb.home}/lib/logkit-1.2.jar${path.separator}${jacorb.home}/lib/avalon-framework-4.1.5.jar -Djacorb.home=${jacorb.home} -Dorg.omg.CORBA.ORBClass=org.jacorb.orb.ORB -Dorg.omg.CORBA.ORBSingletonClass=orb.jacorb.orb.ORBSingleton"/>    
    
    <target name="server_jacorb">
        <java classname="demo.hello.Server" fork="yes">
             <jvmarg line="${jacorb.jvmarg}"/>
         </java>
    </target>  

     <target name="client_jacorb">
         <java classname="demo.hello.Client" fork="yes">
             <jvmarg line="${jacorb.jvmarg}"/>
         </java>
    </target>   
    
     <target name="server_zen">
         <java classname="demo.hello.Server" fork="yes">
             <jvmarg line="-Xbootclasspath/p:C:/Zen/Zen/classes; -Dorg.omg.CORBA.ORBClass=edu.uci.ece.zen.orb.ORB -Dorg.omg.CORBA.ORBSingletonClass=edu.uci.ece.zen.orb.ORBSingleton"/>
         </java>
    </target>  

     <target name="client_zen">
         <java classname="demo.hello.Client" fork="yes">
             <jvmarg line="-Xbootclasspath/p:C:/Zen/Zen/classes; -Dorg.omg.CORBA.ORBClass=edu.uci.ece.zen.orb.ORB -Dorg.omg.CORBA.ORBSingletonClass=edu.uci.ece.zen.orb.ORBSingleton"/>
         </java>
    </target>       

    <target name="clean">
        <demo.clean/>
    </target>

</project>
